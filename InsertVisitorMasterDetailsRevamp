CREATE PROCEDURE [dbo].[InsertVisitorMasterDetailsRevamp](
       @FirstName varchar(100),
       @Company varchar(100),
       @MobileNumber Varchar(50),
       @HostID varchar(10),
       @visitortype  varchar(40),
       @others varchar(50),
       @IsConfidance varchar(10),
       @EmailID varchar(50))
AS
BEGIN
       -- SET NOCOUNT ON added to prevent extra result sets from
       -- interfering with SELECT statements.
       SET NOCOUNT ON;
       declare @newvisitorid int 
       --IF NOT EXISTS(select [MasterVisitorID] from [dbo].[MSTR_VisitorMaster] where FirstName = @FirstName and MobileNo = @MobileNumber)
       --begin
       Declare @MasterVisitorID int=(select TOP 1 MasterVisitorID from MSTR_VisitorMaster where MobileNo=@MobileNumber and FirstName=@FirstName  and Company=@Company)
       if(@MasterVisitorID is null)
       begin
       insert into [MSTR_VisitorMaster](FirstName,Company,MobileNo,CreatedBy,CreatedDate,visitortype,other,IsConfidential,EmailID)
values(@FirstName,@Company,@MobileNumber,@HostID,GETDATE(),@visitortype,LTRIM(RTRIM(@others)),@IsConfidance,@EmailID)
       set @newvisitorid=SCOPE_IDENTITY() 
       select @newvisitorid as [MasterVisitorID],1 as Flag
       end
       else
       begin
       select @MasterVisitorID as [MasterVisitorID],1 as Flag
       end
       --end
       --else
       --begin
       --select [MasterVisitorID],0 as Flag from [dbo].[MSTR_VisitorMaster] where FirstName = @FirstName and MobileNo = @MobileNumber
       --end
END
