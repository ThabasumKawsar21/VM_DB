CREATE PROCEDURE [dbo].[submitDC_Statustable]

	-- Add the parameters for the stored procedure here

	@DCTempuniqueid int,

	@RequestID int,

	@dcid int

	

AS

BEGIN

	-- SET NOCOUNT ON added to prevent extra result sets from

	-- interfering with SELECT statements.

	SET NOCOUNT ON;



	create table #temp

	(

	    tVisitorId int,

		trequestId int,

        tCountry varchar(50),

        tCity varchar(100),

        tFacility varchar(100),

        tVisitorType varchar(100),

        tCreatedBy varchar(50),

        tCreatedDate datetime,

        tVisitorReqStatus varchar(50),

	    tLastupdateddate_VMS datetime

	) 

    

	insert into #temp

	(   tVisitorId ,

	trequestId,

        tCountry ,

        tCity ,

        tFacility ,

        tVisitorType ,

        tCreatedBy,

        tCreatedDate ,

        tVisitorReqStatus ,

	    tLastupdateddate_VMS ) 

	select [VisitorID]

	,[RequestID]

      ,[Country]

      ,[City]

      ,[Facility]

      ,[Purpose]

	  ,[Createdby]

      ,[CreatedDate]

	  ,[Status]

	  ,[LastUpdatedDate]

	   from visitorrequest where requestid=@RequestID

	



	update DC_Status set visitorid=t.tVisitorId

	,RequestID_VMS=t.trequestId

	   ,[Country]=t.tCountry

      ,[City]=t.tCity

      ,[Facility]=t.tFacility

	  ,[VisitorType]=t.tVisitorType

	  ,[Createdby]=t.tCreatedBy

      ,[CreatedDate]=t.tCreatedDate

	  ,[VisitorReqStatus]=t.tVisitorReqStatus

	  ,[Lastupdateddate_VMS]=t.tLastupdateddate_VMS 

	  ,[DCStatus]='Pending' 
	  
	  ,[DCUnique_Id]=@dcid
	  from  #temp t where TempUnique_Id=@DCTempuniqueid



	drop table #temp

END
