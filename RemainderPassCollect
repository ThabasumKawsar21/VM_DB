CREATE PROCEDURE [dbo].[RemainderPassCollect]
	-- Add the parameters for the stored procedure here
	
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	select distinct(CRD.ParentrefernceID),DATEDIFF(hour,CRD.notifiedtime,getdate()) as datedifference,
CRD.RemainderPassCollect,VR.HostID,VR.Facility
 from ClientRequestDetails CRD 
 join VisitorRequest VR on CRD.parentrefernceID = VR.ParentreferenceID
 where 
NotificationToHost=1 and DispatchedToHost is NULL
END
